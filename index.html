<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tools for Business Calendars • almanac</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Tools for Business Calendars">
<meta property="og:description" content="Provides tools for creating business calendars with 
    custom holidays. Calendars can then be used to shift dates or generate 
    sequences relative to that calendar.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">almanac</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/DavisVaughan/almanac">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    
<!-- README.md is generated from README.Rmd. Please edit that file -->
<div id="almanac" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#almanac" class="anchor"></a>almanac</h1></div>
<!-- badges: start -->

<p>almanac provides tools for working with dates relative to business calendars. Specifically, it provides utilities to:</p>
<ul>
<li><p>Create calendar objects with predefined holidays / weekends.</p></li>
<li><p>Extend or tweak these calendar objects with custom holidays.</p></li>
<li><p>Shift dates forwards or backwards relative to a calendar, skipping over weekends and holidays.</p></li>
<li><p>Generate date sequences relative to a calendar, skipping over weekends and holidays.</p></li>
</ul>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can NOT install almanac from <a href="https://CRAN.R-project.org">CRAN</a>.</p>
<p>You can install the development version from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># install.packages("devtools")</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">"DavisVaughan/almanac"</span>)</a></code></pre></div>
</div>
<div id="examples" class="section level2">
<h2 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(almanac)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(lubridate, <span class="dt">warn.conflicts =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr, <span class="dt">warn.conflicts =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">123</span>)</a></code></pre></div>
<p>Imagine you have a sequence of business dates indexing some value, like a business cost.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">costs &lt;-<span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">tibble</a></span>(</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">  <span class="dt">cost =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">5</span>, <span class="dt">mean =</span> <span class="dv">10000</span>, <span class="dt">sd =</span> <span class="dv">500</span>),</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">  <span class="dt">dates =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.Date">as.Date</a></span>(<span class="st">"2019-02-13"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">6</span><span class="op">:</span><span class="dv">7</span>)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5"></a>
<a class="sourceLine" id="cb3-6" data-line-number="6">costs</a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt; # A tibble: 5 x 2</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt;     cost dates     </span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt;    &lt;dbl&gt; &lt;date&gt;    </span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt; 1  9720. 2019-02-13</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#&gt; 2  9885. 2019-02-14</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt; 3 10779. 2019-02-15</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt; 4 10035. 2019-02-19</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt; 5 10065. 2019-02-20</span></a></code></pre></div>
<p>Importantly, these are <em>business dates</em>. Generally, that means that there won’t be any weekend values, and holidays are observed and also won’t generate any values. In this data set, <code>02/16 - 02/17</code> is a weekend, and <code>02/18</code> is President’s Day.</p>
<p>To perform any kind of rolling calculation correctly, you might need to “look forwards” by some number of business days. This is different from just looking forward “1 day”, because when you are at Friday, you really want to look forward to Monday. But if Monday is a holiday (as it is here!), you really want that to actually shift to Tuesday, the actual next business day.</p>
<p>almanac provides tools for constructing calendars with holidays and weekend support to help with these problems.</p>
<p>Notice that in the example below, <code>"2019-02-15"</code> is shifted to <code>"2019-02-19"</code> when we request a 1 day shift (using a <code><a href="http://lubridate.tidyverse.org/reference/period.html">lubridate::days()</a></code> period object!). It skips over the weekend and President’s Day to locate the next business day.</p>
<p>In the 5 day shift, <code>"2019-02-19"</code>, a Tuesday, is shifted all the way to <code>"2019-02-26"</code>, the next Tuesday, which corresponds to a “business week” and skips over the weekend.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># Construct a calendar object, the default is a US calendar</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">cal &lt;-<span class="st"> </span><span class="kw"><a href="reference/calendar.html">calendar</a></span>()</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">cal</a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt; &lt;Calendar: united_states&gt;</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co"># Use the new calendar object alongside `cal_shift()` to shift </span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co"># by a number of business days.</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8">costs <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(</a>
<a class="sourceLine" id="cb4-10" data-line-number="10">    <span class="dt">dates_wday =</span> <span class="kw"><a href="http://lubridate.tidyverse.org/reference/day.html">wday</a></span>(dates, <span class="dt">label =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb4-11" data-line-number="11">    <span class="dt">one_day =</span> <span class="kw"><a href="reference/cal_shift.html">cal_shift</a></span>(dates, <span class="kw"><a href="http://lubridate.tidyverse.org/reference/period.html">days</a></span>(<span class="dv">1</span>), <span class="dt">cal =</span> cal),</a>
<a class="sourceLine" id="cb4-12" data-line-number="12">    <span class="dt">one_wday =</span> <span class="kw"><a href="http://lubridate.tidyverse.org/reference/day.html">wday</a></span>(one_day, <span class="dt">label =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb4-13" data-line-number="13">    <span class="dt">five_days =</span> <span class="kw"><a href="reference/cal_shift.html">cal_shift</a></span>(dates, <span class="kw"><a href="http://lubridate.tidyverse.org/reference/period.html">days</a></span>(<span class="dv">5</span>), <span class="dt">cal =</span> cal),</a>
<a class="sourceLine" id="cb4-14" data-line-number="14">    <span class="dt">five_wday =</span> <span class="kw"><a href="http://lubridate.tidyverse.org/reference/day.html">wday</a></span>(five_days, <span class="dt">label =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb4-15" data-line-number="15">  )</a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt; # A tibble: 5 x 7</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt;     cost dates      dates_wday one_day    one_wday five_days  five_wday</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#&gt;    &lt;dbl&gt; &lt;date&gt;     &lt;ord&gt;      &lt;date&gt;     &lt;ord&gt;    &lt;date&gt;     &lt;ord&gt;    </span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">#&gt; 1  9720. 2019-02-13 Wed        2019-02-14 Thu      2019-02-21 Thu      </span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="co">#&gt; 2  9885. 2019-02-14 Thu        2019-02-15 Fri      2019-02-22 Fri      </span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="co">#&gt; 3 10779. 2019-02-15 Fri        2019-02-19 Tue      2019-02-25 Mon      </span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="co">#&gt; 4 10035. 2019-02-19 Tue        2019-02-20 Wed      2019-02-26 Tue      </span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"><span class="co">#&gt; 5 10065. 2019-02-20 Wed        2019-02-21 Thu      2019-02-27 Wed</span></a></code></pre></div>
<p>You can tweak the calendar by adding new holidays, or removing existing ones. Here we add Thursday the 21st as a holiday, but remove President’s Day for that year.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">cal_tweaked &lt;-<span class="st"> </span>cal <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="reference/holidays_add.html">holidays_add</a></span>(<span class="st">"2019-02-21"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="reference/holidays_add.html">holidays_remove</a></span>(<span class="st">"2019-02-18"</span>)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">cal_tweaked</a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; &lt;Calendar: united_states&gt;</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; Added holidays: </span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt;  - 2019-02-21</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt; Removed holidays: </span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt;  - 2019-02-18</span></a></code></pre></div>
<p>Running the same code as before with the updated calendar has different results. <code>"2019-02-15"</code> now shifts forward over the weekend but lands on <code>"2019-02-18"</code>, since we removed President’s Day as a holiday. Shifting <code>"2019-02-19"</code> 5 business days forwards now no longer lands on another Tuesday since <code>"2019-02-21"</code> is now an additional holiday. Instead, it lands one day further on a Wednesday.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">costs <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">    <span class="dt">dates_wday =</span> <span class="kw"><a href="http://lubridate.tidyverse.org/reference/day.html">wday</a></span>(dates, <span class="dt">label =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">    <span class="dt">one_day =</span> <span class="kw"><a href="reference/cal_shift.html">cal_shift</a></span>(dates, <span class="kw"><a href="http://lubridate.tidyverse.org/reference/period.html">days</a></span>(<span class="dv">1</span>), <span class="dt">cal =</span> cal_tweaked),</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">    <span class="dt">one_wday =</span> <span class="kw"><a href="http://lubridate.tidyverse.org/reference/day.html">wday</a></span>(one_day, <span class="dt">label =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">    <span class="dt">five_days =</span> <span class="kw"><a href="reference/cal_shift.html">cal_shift</a></span>(dates, <span class="kw"><a href="http://lubridate.tidyverse.org/reference/period.html">days</a></span>(<span class="dv">5</span>), <span class="dt">cal =</span> cal_tweaked),</a>
<a class="sourceLine" id="cb6-7" data-line-number="7">    <span class="dt">five_wday =</span> <span class="kw"><a href="http://lubridate.tidyverse.org/reference/day.html">wday</a></span>(five_days, <span class="dt">label =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">  )</a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; # A tibble: 5 x 7</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt;     cost dates      dates_wday one_day    one_wday five_days  five_wday</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt;    &lt;dbl&gt; &lt;date&gt;     &lt;ord&gt;      &lt;date&gt;     &lt;ord&gt;    &lt;date&gt;     &lt;ord&gt;    </span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt; 1  9720. 2019-02-13 Wed        2019-02-14 Thu      2019-02-20 Wed      </span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt; 2  9885. 2019-02-14 Thu        2019-02-15 Fri      2019-02-22 Fri      </span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt; 3 10779. 2019-02-15 Fri        2019-02-18 Mon      2019-02-25 Mon      </span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt; 4 10035. 2019-02-19 Tue        2019-02-20 Wed      2019-02-27 Wed      </span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">#&gt; 5 10065. 2019-02-20 Wed        2019-02-22 Fri      2019-02-28 Thu</span></a></code></pre></div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>This package embeds a hand curated subset of <a href="https://github.com/lballabio/QuantLib">QuantLib</a> to handle the date calculations. almanac is standalone, and does not require a separate installation of QuantLib.</p>
<p>There are a few other packages out there that have attempted similar projects.</p>
<ul>
<li><p><a href="https://github.com/eddelbuettel/rquantlib">RQuantLib</a> exposes a few of the adjustment tools from QuantLib, but provides no support for custom calendars and holidays. Additionally, it requires a separate installation of QuantLib to link to, which can be a bit heavy. Other than that, it is a great tool with a more broad subset of utilities, such as option pricing.</p></li>
<li><p><a href="https://github.com/eddelbuettel/rcppquantuccia">RcppQuantuccia</a> is a header only subset of QuantLib that also includes the calendar sections, but again has no support for custom calendars. It did provide me with some of the basic infrastructure to get started though, so I’m grateful for that.</p></li>
<li><p><a href="https://github.com/wilsonfreitas/R-bizdays">bizdays</a> has the most similar API and range of features to almanac.</p></li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/DavisVaughan/almanac">https://​github.com/​DavisVaughan/​almanac</a>
</li>
<li>Report a bug at <br><a href="https://github.com/DavisVaughan/almanac/issues">https://​github.com/​DavisVaughan/​almanac/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Davis Vaughan <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>


      <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/DavisVaughan/almanac"><img src="https://travis-ci.org/DavisVaughan/almanac.svg?branch=master" alt="Travis build status"></a></li>
<li><a href="https://codecov.io/gh/DavisVaughan/almanac?branch=master"><img src="https://codecov.io/gh/DavisVaughan/almanac/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Davis Vaughan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
